<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2563eb">
  <title>Livora</title>
</head>
<body>
  <h2>Loading Livora...</h2>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDakNFuEjYdZPWrYTJE_pQEk6uYJyd2kH8",
      authDomain: "fir-url-28872.firebaseapp.com",
      databaseURL: "https://fir-url-28872-default-rtdb.firebaseio.com",
      projectId: "fir-url-28872",
      storageBucket: "fir-url-28872.firebasestorage.app",
      messagingSenderId: "261304356766",
      appId: "1:261304356766:web:c37a12e3bba39d67d9108f"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const tunnelsRef = ref(db, 'tunnels');

    onValue(tunnelsRef, (snapshot) => {
      const data = snapshot.val();
      if (data) {
        // Assuming there is a single URL, take the first one
        const firstUrl = Object.values(data)[0].url;
        window.location.href = firstUrl;
      }
    });

    // Register Service Worker for PWA
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js")
        .then(() => console.log("Service Worker Registered"))
        .catch(err => console.error("SW registration failed:", err));
    }
  </script>
</body>
</html>
